<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write-up Nest Machine | PCW3R</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Write-up Nest Machine" /><meta name="author" content="pcw3r" /><meta property="og:locale" content="en_US" /><meta name="description" content="Ref°: HTB-07-Boot2Root" /><meta property="og:description" content="Ref°: HTB-07-Boot2Root" /><link rel="canonical" href="https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/" /><meta property="og:url" content="https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/" /><meta property="og:site_name" content="PCW3R" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-06T05:33:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Write-up Nest Machine" /><meta name="twitter:site" content="@PCW3R" /><meta name="twitter:creator" content="@pcw3r" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Write-up Nest Machine","description":"Ref°: HTB-07-Boot2Root","datePublished":"2020-06-06T05:33:00+02:00","dateModified":"2020-06-06T05:33:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/"},"url":"https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/","author":{"@type":"Person","name":"pcw3r"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div class="profile-text mt-3"><div class="site-title"> <a href="/">PCW3R</a></div><div class="site-subtitle font-italic">Think outside the box.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/PCW3R" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/PCW3R" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['pcw3r','protonmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Write-up Nest Machine</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Write-up Nest Machine</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Sat, Jun 6, 2020, 5:33 AM +0200"> {"long"=>"Jun 6, 2020", "short"=>"Jun 6"} <i class="unloaded">2020-06-06T05:33:00+02:00</i> </span> by <span class="author"> pcw3r </span></div></div><div class="post-tail-wrapper-head"> <i class="fas fa-hourglass-half fa-fw mr-1"></i> <span class="reading-time" title="Estimated read time"> 10 mins read </span></div><div class="post-content"><p><strong><center>Ref°: HTB-07-Boot2Root</center></strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Badge-Nest.png" alt="Desktop View" /></p><p>— Nest is a Windows machine which highlights the risks of an insecure file system through available and exploitable shares.</p><p>Review Code on two programs found in the SMB service, allows to decrypt the hash of a user and the administrator. The hash of the administrator being visible in a legacy service (HQK) using the debug password that was hidden in a file via ADS.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Information-Nest.png" alt="Desktop View" /></p><h2 id="1-discovery---figure-out-environment"><strong><span style="color:#c0392b">[1] Discovery - Figure out environment</span></strong></h2><h3 id="check-all-services">Check all services</h3><hr /><p>Nmap scan reveal smb service on her usual port and an other port assigned by a unknow service.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">-Pn</span> <span class="nt">-T5</span> 10.10.10.178 <span class="nt">-p-</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-nmap.png" alt="Desktop View" /></p><h3 id="smb">Smb</h3><hr /><p>This service reveal many shares visible without authentication : <code class="language-plaintext highlighter-rouge">ADMIN$, C$, Data, IPC$, Secure$, Users</code></p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>smblcient <span class="nt">-L</span> 10.10.10.178
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-smbanonym.png" alt="Desktop View" /></p><h3 id="hqk">HQK</h3><hr /><p>Telnet connection on port <code class="language-plaintext highlighter-rouge">4386</code>, reveals service named <code class="language-plaintext highlighter-rouge">HQK Reporting Service V1.2</code>.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>telnet 10.10.10.178 4386
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-hqktelnet.png" alt="Desktop View" /></p><h3 id="vulnerabilities">Vulnerabilities</h3><hr /><p>No vulnerabilities identify here, but we have possibility to mount and enum shares in anonymous mode. We can exploit this to access and gain a foothold.</p><p>The connection to the HQK service is not protected by authentication. But at this point we don’t have enough information to know how to exploit this path.</p><h2 id="2foothold---get-into-the-target-"><strong><span style="color:#c0392b">[2] Foothold - Get into the target </span></strong></h2><h3 id="unsecured-file-sharing">Unsecured File Sharing</h3><hr /><p>We have two shares that give access to the machine and gain foothold : <code class="language-plaintext highlighter-rouge">Data, Users</code>. We switch to Windows to access these two shares and we enumerate to perform a lateral movement.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-visibleshares.png" alt="Desktop View" /></p><h3 id="plaintext-password-from-email">Plaintext Password from email</h3><hr /><p>We find temporary credentials below <code class="language-plaintext highlighter-rouge">\\10.10.10.178\Data\Shared\Templates\HR\Welcome Email.text</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-welcome.png" alt="Desktop View" /></p><h3 id="remote-service-smb-login">Remote Service SMB login</h3><hr /><p>This temporary user give us more elements from smb service. <code class="language-plaintext highlighter-rouge">smbmap command</code> show us the possibility to access an a other share : <code class="language-plaintext highlighter-rouge">SECURE$</code></p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>smbmap <span class="nt">-u</span> TempUser <span class="nt">-p</span> welcome2019 <span class="nt">-H</span> 10.10.10.178
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-smbtemp.png" alt="Desktop View" /></p><h2 id="3-lateral-movement---move-through-environment"><strong><span style="color:#c0392b">[3] Lateral Movement - Move through environment</span></strong></h2><h3 id="hashed-password-from-xml-file">Hashed Password from .xml file</h3><hr /><p>We mount this share on our Windows machine with <code class="language-plaintext highlighter-rouge">net use command</code>.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>net use LETTER: <span class="se">\\</span>10.10.10.178<span class="se">\S</span>HARES /user:TempUser welcome2019
</pre></table></code></div></div><p>We find configuration file with <code class="language-plaintext highlighter-rouge">hash password</code> of user C.Smith below <code class="language-plaintext highlighter-rouge">\\10.10.10.178\Data\IT\Config\RU Scanner\RU_config.xml</code></p><p>This file seem to be associated of program named <code class="language-plaintext highlighter-rouge">RU Scanner.</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-ruconfig.png" alt="Desktop View" /></p><h3 id="reviewing-code-of-ru-scanner-program">Reviewing Code of RU-Scanner Program</h3><hr /><p>NotepadPlusPlus.xml file make reference to a subfolder in SECURE$ share at <code class="language-plaintext highlighter-rouge">line 99</code> : <code class="language-plaintext highlighter-rouge">Carl</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-reffolder.png" alt="Desktop View" /></p><p>In this subfolder, we find Visual Studio project named <code class="language-plaintext highlighter-rouge">RUScanner</code> under <code class="language-plaintext highlighter-rouge">\VB Project\WIP\RU\</code>. We can find something interesting in this program to potentially decrypt hash ?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-ruscanner.png" alt="Desktop View" /></p><p>After reviewing the program with Visual Studio, we can find two interesting functions in the <code class="language-plaintext highlighter-rouge">utils.vb</code> object : <code class="language-plaintext highlighter-rouge">EncryptString, DecryptString</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-functiondecrypt.png" alt="Desktop View" /></p><p>First, let’s look at the encryption function that encrypted the password of the user C.Smith and result the hash found above.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Public Shared Function EncryptString<span class="o">(</span>PlainString As String<span class="o">)</span> As String
If String.IsNullOrEmpty<span class="o">(</span>PlainString<span class="o">)</span> Then
        Return String.Empty
Else
        Return Encrypt<span class="o">(</span>PlainString, <span class="s2">"N3st22"</span>, <span class="s2">"88552299"</span>, 2, <span class="s2">"464R5DFA5DL6LE28"</span>, 256<span class="o">)</span>
    End If
End Function
</pre></table></code></div></div><p>What we learn here is that to encrypt a string, we use the following :</p><ul><li>passPhrase = <code class="language-plaintext highlighter-rouge">N3st22</code></li><li>saltValue = <code class="language-plaintext highlighter-rouge">88552299</code></li><li>passwordIterations = <code class="language-plaintext highlighter-rouge">2</code></li><li>initVector = <code class="language-plaintext highlighter-rouge">464R5DFA5DL6LE28</code></li><li>keySize = <code class="language-plaintext highlighter-rouge">256</code></li></ul><p>So we have the possiblity to decrypt the hash from function DecryptString.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Public Shared Function DecryptString<span class="o">(</span>EncryptedString As String<span class="o">)</span> As String
If String.IsNullOrEmpty<span class="o">(</span>EncryptedString<span class="o">)</span> Then
        Return String.Empty
Else
        Return Decrypt<span class="o">(</span>EncryptedString, <span class="s2">"N3st22"</span>, <span class="s2">"88552299"</span>, 2, <span class="s2">"464R5DFA5DL6LE28"</span>, 256<span class="o">)</span>
    End If
End Function
</pre></table></code></div></div><h3 id="decrypting-password">Decrypting Password</h3><hr /><p>We create a new vb project and insert only the functions we need.</p><p>Reference - my vb program : <a href="https://github.com/PCW3R/Tools-Programs/tree/master/Decrypt-Nest-Rfc2898DeriveBytes">https://github.com/PCW3R/Tools-Programs/tree/master/Decrypt-Nest-Rfc2898DeriveBytes</a></p><p><strong>Utils.vb :</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre>Imports System.Text
Imports System.Security.Cryptography
Public Class Utils

    Public Shared Function GetLogFilePath<span class="o">()</span> As String
        Return IO.Path.Combine<span class="o">(</span>Environment.CurrentDirectory, <span class="s2">"Log.txt"</span><span class="o">)</span>
    End Function


    Public Shared Function DecryptString<span class="o">(</span>EncryptedString As String<span class="o">)</span> As String
        If String.IsNullOrEmpty<span class="o">(</span>EncryptedString<span class="o">)</span> Then
            Return String.Empty
        Else
            Return Decrypt<span class="o">(</span>EncryptedString, <span class="s2">"N3st22"</span>, <span class="s2">"88552299"</span>, 2, <span class="s2">"464R5DFA5DL6LE28"</span>, 256<span class="o">)</span>
        End If
    End Function

    Public Shared Function Decrypt<span class="o">(</span>ByVal cipherText As String,
                                   ByVal passPhrase As String,
                                   ByVal saltValue As String,
                                    ByVal passwordIterations As Integer,
                                   ByVal initVector As String,
                                   ByVal keySize As Integer<span class="o">)</span> _
                           As String

        Dim initVectorBytes As Byte<span class="o">()</span>
        initVectorBytes <span class="o">=</span> Encoding.ASCII.GetBytes<span class="o">(</span>initVector<span class="o">)</span>

        Dim saltValueBytes As Byte<span class="o">()</span>
        saltValueBytes <span class="o">=</span> Encoding.ASCII.GetBytes<span class="o">(</span>saltValue<span class="o">)</span>

        Dim cipherTextBytes As Byte<span class="o">()</span>
        cipherTextBytes <span class="o">=</span> Convert.FromBase64String<span class="o">(</span>cipherText<span class="o">)</span>

        Dim password As New Rfc2898DeriveBytes<span class="o">(</span>passPhrase,
                                           saltValueBytes,
                                           passwordIterations<span class="o">)</span>

        Dim keyBytes As Byte<span class="o">()</span>
        keyBytes <span class="o">=</span> password.GetBytes<span class="o">(</span>CInt<span class="o">(</span>keySize / 8<span class="o">))</span>

        Dim symmetricKey As New AesCryptoServiceProvider
        symmetricKey.Mode <span class="o">=</span> CipherMode.CBC

        Dim decryptor As ICryptoTransform
        decryptor <span class="o">=</span> symmetricKey.CreateDecryptor<span class="o">(</span>keyBytes, initVectorBytes<span class="o">)</span>

        Dim memoryStream As IO.MemoryStream
        memoryStream <span class="o">=</span> New IO.MemoryStream<span class="o">(</span>cipherTextBytes<span class="o">)</span>

        Dim cryptoStream As CryptoStream
        cryptoStream <span class="o">=</span> New CryptoStream<span class="o">(</span>memoryStream,
                                        decryptor,
                                        CryptoStreamMode.Read<span class="o">)</span>

        Dim plainTextBytes As Byte<span class="o">()</span>
        ReDim plainTextBytes<span class="o">(</span>cipherTextBytes.Length<span class="o">)</span>

        Dim decryptedByteCount As Integer
        decryptedByteCount <span class="o">=</span> cryptoStream.Read<span class="o">(</span>plainTextBytes,
                                               0,
                                               plainTextBytes.Length<span class="o">)</span>

        memoryStream.Close<span class="o">()</span>
        cryptoStream.Close<span class="o">()</span>

        Dim plainText As String
        plainText <span class="o">=</span> Encoding.ASCII.GetString<span class="o">(</span>plainTextBytes,
                                            0,
                                            decryptedByteCount<span class="o">)</span>

        Return plainText
    End Function

End Class
</pre></table></code></div></div><p><strong>Program.vb :</strong> We pass the hash value like EncryptedString and call the function DecryptString to result in console the password in plaintext of the user C.Smith.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Imports System

Module Program
  Sub Main<span class="o">(</span>args As String<span class="o">())</span>
        Console.WriteLine<span class="o">(</span>Utils.DecryptString<span class="o">(</span>EncryptedString:<span class="o">=</span><span class="s2">"fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE="</span><span class="o">))</span>
  End Sub
End Module
</pre></table></code></div></div><p>The password is decrypted : <strong>xRxRxPANCAK3SxRxRx</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-decryptresult1.png" alt="Desktop View" /></p><h3 id="flag-user">Flag user</h3><hr /><p>And we flag the user.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>net use LETTER: <span class="se">\\</span>10.10.10.178<span class="se">\U</span>SERS /user:C.Smith xRxRxPANCAK3SxRxRx
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-flaguser.png" alt="Desktop View" /></p><h2 id="4-privilege-escalation---gain-higher-level-permissions"><strong><span style="color:#c0392b">[4] Privilege Escalation - Gain higher-level permissions</span></strong></h2><h3 id="enumeration-under-csmith-account">Enumeration under C.Smith account</h3><hr /><p>We enum under C.Smith account on SMB service and find several things :</p><ul><li>Program <code class="language-plaintext highlighter-rouge">HqkLdap.exe</code> can be find under <code class="language-plaintext highlighter-rouge">\\10.10.10.178\USERS\C.Smith\HQK Reporting\AD Integration Module\</code></li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-hqkldap.png" alt="Desktop View" /></p><ul><li>A <code class="language-plaintext highlighter-rouge">configuration file</code> of the service HQK can be find under <code class="language-plaintext highlighter-rouge">\\10.10.10.178\USERS\C.Smith\HQK Reporting\HQK_Config_Backup.xml</code> with a reference to <code class="language-plaintext highlighter-rouge">port 4386</code></li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-port.png" alt="Desktop View" /></p><ul><li>And <code class="language-plaintext highlighter-rouge">empty file</code> can be find under <code class="language-plaintext highlighter-rouge">\\10.10.10.178\USERS\C.Smith\HQK Reporting\Debug Mode Password.txt</code> with reference to <code class="language-plaintext highlighter-rouge">DEBUG Password</code> of the service HQK</li></ul><h3 id="debug-mode-password">Debug Mode Password</h3><hr /><p>The HQK service is accessible without authentication but it is useless in this context. To go further and find other interesting elements to raise our privileges, we need to find the Debug Mode Password of the service.</p><p>The file <code class="language-plaintext highlighter-rouge">Debug Mode Password.txt</code> seem to be empty on the face of it. But in reality the file hide data through <code class="language-plaintext highlighter-rouge">ADS</code>.</p><p>Reference - ADS tool : <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/streams">https://docs.microsoft.com/en-us/sysinternals/downloads/streams</a></p><p>ADS or Alternate Data Stream is the ability of an NTFS file system (the main file system format in Windows) to store different streams of data, in addition to the default stream which is normally used for a file.</p><p>ADS have been given a bad reputation because their capability to hide data from us on our own computer, has been abused by malware writers in the past. Here we use ADS to hide the debug password : <strong>WBQ201953D8w</strong></p><p>Reference - ADS method : <a href="https://www.asafety.fr/administration-reseaux-et-systemes/les-ads-de-windows-pour-camoufler-vos-fichiers-dans-des-fichiers/">https://www.asafety.fr/administration-reseaux-et-systemes/les-ads-de-windows-pour-camoufler-vos-fichiers-dans-des-fichiers/</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>dir /R
Debug Mode Password.txt:Password:$DATA

more &lt; "Debug Mode Password.txt":Password
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-ads.png" alt="Desktop View" /></p><h3 id="hashed-password-through-hqk">Hashed Password through HQK</h3><hr /><p>We use the Debug Password and find the hash password of the Administrator in <code class="language-plaintext highlighter-rouge">Ldap.conf</code>.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>telnet 10.10.10.178 4386
<span class="gp">&gt;</span><span class="w"> </span>DEBUG WBQ201953D8w
<span class="gp">&gt;</span><span class="w"> </span>SETDIR ..
<span class="gp">&gt;</span><span class="w"> </span>SETDIR ldap
<span class="gp">&gt;</span><span class="w"> </span>SHOWQUERY 2
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-hqk.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-hqk2.png" alt="Desktop View" /></p><p>We have the hash and we’re going to proceed in the same way to decrypt it. But we need to know the good values of <code class="language-plaintext highlighter-rouge">passPhrase / saltvalue / passwordIterations / initVector and keySize</code>.</p><h3 id="reviewing-code-hqkldapexe">Reviewing Code HqkLdap.exe</h3><hr /><p>We decompile the program HqkLdap.exe with <code class="language-plaintext highlighter-rouge">ILSpy tool</code> and find the correct values.</p><p>Reference - ILSpy tool : <a href="https://github.com/icsharpcode/ILSpy">https://github.com/icsharpcode/ILSpy</a></p><ul><li>passPhrase = <code class="language-plaintext highlighter-rouge">667912</code></li><li>saltValue = <code class="language-plaintext highlighter-rouge">1313Rf99</code></li><li>passwordIterations = <code class="language-plaintext highlighter-rouge">3</code></li><li>initVector = <code class="language-plaintext highlighter-rouge">1L1SA61493DRV53Z</code></li><li>keySize = <code class="language-plaintext highlighter-rouge">256</code></li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-decompil.png" alt="Desktop View" /></p><h3 id="decrypting-password-1">Decrypting Password</h3><hr /><p>We replace this values in our program :</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Else
Return Decrypt(EncryptedString, "passPhrase", "saltValue", "passwordIterations", "initvector", "keySize")
End If
</pre></table></code></div></div><p>And pass the hash value to decrypt the password : <strong>XtH4nkS4Pl4y1nGX</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Imports System

Module Program
  Sub Main<span class="o">(</span>args As String<span class="o">())</span>
        Console.WriteLine<span class="o">(</span>Utils.DecryptString<span class="o">(</span>EncryptedString:<span class="o">=</span><span class="s2">"yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4="</span><span class="o">))</span>
  End Sub
End Module
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-decryptresult2.png" alt="Desktop View" /></p><p>We get full control of Nest machine.</p><h3 id="flag-root">Flag root</h3><hr /><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>net use LETTER: <span class="se">\\</span>10.10.10.178<span class="se">\C</span><span class="nv">$ </span>/user:Administrator XtH4nkS4Pl4y1nGX
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/nest/HTB-Images-Nest-flagroot.png" alt="Desktop View" /></p><hr /><h2 id="trophy"><strong><center>Trophy</center></strong></h2><blockquote><p><strong>Look up at the stars and not down at your feet.</strong></p><p>Stephen Hawking</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/boot2root/'>Boot2Root</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >WINDOWS</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >EASY</a> <a href="/tags/enumeration/" class="post-tag no-text-decoration" >ENUMERATION</a> <a href="/tags/review-code/" class="post-tag no-text-decoration" >REVIEW CODE</a> <a href="/tags/password-decrypt/" class="post-tag no-text-decoration" >PASSWORD DECRYPT</a> <a href="/tags/alternate-data-stream/" class="post-tag no-text-decoration" >ALTERNATE DATA STREAM</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Write-up Nest Machine - PCW3R&url=https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Write-up Nest Machine - PCW3R&u=https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Write-up Nest Machine - PCW3R&url=https://pcw3r.github.io/posts/HTB-07-Pentest-Nest/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">LINUX</a> <a class="post-tag" href="/tags/web-exploitation/">WEB EXPLOITATION</a> <a class="post-tag" href="/tags/payload/">PAYLOAD</a> <a class="post-tag" href="/tags/password-cracking/">PASSWORD CRACKING</a> <a class="post-tag" href="/tags/medium/">MEDIUM</a> <a class="post-tag" href="/tags/database-exploitation/">DATABASE EXPLOITATION</a> <a class="post-tag" href="/tags/active-directory-exploitation/">ACTIVE DIRECTORY EXPLOITATION</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/sudo-exploitation/">SUDO EXPLOITATION</a> <a class="post-tag" href="/tags/password-decrypt/">PASSWORD DECRYPT</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTB-06-Pentest-Resolute/" class="btn btn-outline-primary"><p>Write-up Resolute Machine</p></a> <a href="/posts/HTB-08-Pentest-Monteverde/" class="btn btn-outline-primary"><p>Write-up Monteverde Machine</p></a></div><!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-12-Pentest-Cascade/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jul 25, 2020 <i class="unloaded">2020-07-25T17:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Write-up Cascade Machine</h3><div class="text-muted small"><p> Ref°: HTB-12-Boot2Root ![Desktop View]({{ “/assets/img/cascade/HTB-Badge-Cascade.png” relative_url }}) — Cascade is a Windows Medium machine which highlights the mis...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-15-Pentest-Remote/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 25, 2020 <i class="unloaded">2020-09-25T11:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Write-up Remote Machine</h3><div class="text-muted small"><p> Ref°: HTB-15-Boot2Root ![Desktop View]({{ “/assets/img/remote/HTB-Badge-Remote.png” relative_url }}) — Remote is a vulnerable machine through a misconfigured NFS sha...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-11-Pentest-Sauna/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jul 18, 2020 <i class="unloaded">2020-07-18T11:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Write-up Sauna Machine</h3><div class="text-muted small"><p> Ref°: HTB-11-Boot2Root ![Desktop View]({{ “/assets/img/sauna/HTB-Badge-Sauna.png” relative_url }}) — Sauna is a Windows machine that highlights the enumeration of us...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/pcw3r">pcw3r</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">LINUX</a> <a class="post-tag" href="/tags/web-exploitation/">WEB EXPLOITATION</a> <a class="post-tag" href="/tags/payload/">PAYLOAD</a> <a class="post-tag" href="/tags/password-cracking/">PASSWORD CRACKING</a> <a class="post-tag" href="/tags/medium/">MEDIUM</a> <a class="post-tag" href="/tags/database-exploitation/">DATABASE EXPLOITATION</a> <a class="post-tag" href="/tags/active-directory-exploitation/">ACTIVE DIRECTORY EXPLOITATION</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/sudo-exploitation/">SUDO EXPLOITATION</a> <a class="post-tag" href="/tags/password-decrypt/">PASSWORD DECRYPT</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://pcw3r.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
